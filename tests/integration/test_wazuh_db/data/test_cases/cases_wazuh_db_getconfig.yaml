- name: Get config missing parameter
  description: Check the behavior when the parameters are missing.
  configuration_parameters:
    INPUT: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api"}'
    OUTPUT: '{"error":4,"message":"Empty parameters","data":{}}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api"}'
    output: '{"error":4,"message":"Empty parameters","data":{}}'

- name: Get config empty parameters
  description: Check the behavior when the parameters are empty.
  configuration_parameters:
    INPUT: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": {}}'
    OUTPUT: '{"error":5,"message":"Empty section","data":{}}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": {}}'
    output: '{"error":5,"message":"Empty section","data":{}}'

- name: Get config empty section
  description: Check the behavior when the section is empty.
  configuration_parameters:
    INPUT: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section":}}'
    OUTPUT: '{"error":1,"message":"Invalid JSON input","data":{}}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section":}}'
    output: '{"error":1,"message":"Invalid JSON input","data":{}}'

- name: Get config wrong parameter
  description: Check the behavior when the parameters are wrong.
  configuration_parameters:
    INPUT:  '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "wrong_parameter"}}'
    OUTPUT: '{"error":6,"message":"Unrecognized or not configured section","data":{}}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "wrong_parameter"}}'
    output: '{"error":6,"message":"Unrecognized or not configured section","data":{}}'

- name: Get internal config
  description: Check the behavior when the internal config is requested.
  configuration_parameters:
    INPUT:  '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "internal"}}'
    OUTPUT: '"data":{"wazuh_db":{"commit_time_max":60,"commit_time_min":10,"open_db_limit":64,"worker_pool_size":8,"fragmentation_threshold":80,"fragmentation_delta":5,"free_pages_percentage":5,"max_fragmentation":95,"check_fragmentation_interval":43200}}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "internal"}}'
    output: '"data":{"wazuh_db":{"commit_time_max":60,"commit_time_min":10,"open_db_limit":64,"worker_pool_size":8,"fragmentation_threshold":80,"fragmentation_delta":5,"free_pages_percentage":5,"max_fragmentation":95,"check_fragmentation_interval":43200}}'

- name: Get wdb config
  description: Check the behavior when the wdb config is requested.
  configuration_parameters:
    INPUT:  '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "wdb"}}'
    OUTPUT: '"data":{"wdb":{"backup":[{"database":"global","enabled":true,"interval":86400,"max_files":3}]}'
  metadata:
    input: '{"version": 1, "origin": {"module": "api"}, "command": "getconfig", "module": "api", "parameters": { "section": "wdb"}}'
    output: '"data":{"wdb":{"backup":[{"database":"global","enabled":true,"interval":86400,"max_files":3}]}'

---
name: decoder/syslog/0

sources:
  - decoder/syslog-queue/0

metadata:
  description: Syslog header
  references: [ https://datatracker.ietf.org/doc/html/rfc3164, https://datatracker.ietf.org/doc/html/rfc5424 ]
  product.name: Syslog
  formats: [ rfc3164, rfc5424 ]
  json_event_name: syslog

check:
  - event.original: +ef_exists

parse:
  logpar:
    # BSD Syslog RFC 3164 standard
    - event.original: "<~timestamp/timestamp/SYSLOG> <host.hostname> <process.name>[<process.pid>]:<~/ignore/ ><message>"
    # BSD Syslog RFC 3164 no pid
    - event.original: "<~timestamp/timestamp/SYSLOG> <host.hostname> <process.name>:<~/ignore/ ><message>"

    # BSD Syslog RFC 3164 standard ISO8601
    - event.original: "<~timestamp/timestamp/ISO8601> <host.hostname> <process.name>[<process.pid>]: <message>"
    # BSD Syslog RFC 3164 no pid ISO8601
    - event.original: "<~timestamp/timestamp/ISO8601> <host.hostname> <process.name>: <message>"

normalize:
  - map:
      - event.kind: event
      - related.hosts: +a_append/$host.hostname

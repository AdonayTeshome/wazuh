name: decoder/apache-error/0

sources:
  - decoder/queue-syslog/0
  - decoder/queue-localfile/0

metadata:
  module: un modulo
  compatibility: ello
  author:
    name: manolo
    date: ayer
  references:
    - ellas
  title: Hola lorenzo
  description: Decoder for Apache HTTP Server
  product:
    - name: Apache HTTP Server
    - version: 2.4
    - reference:
        - https://httpd.apache.org/docs/2.4/custom-error.html

check:
  - event.original:
      "+r_match/^\\["
      # +r_match/Wed Oct 20 19:20:59.121211 2021
      # [Wed Oct 20 19:20:59.121211 2021] [rewrite:trace3] [pid 121591:tid 140413273032448] mod_rewrite.c(470): [client 10.121.192.8:38350] 10.121.192.8 - - [dev.elastic.co/sid#55a374e851c8][rid#7fb438083ac0/initial] applying pattern '^/import/?(.*)$' to uri '/'
      # [Wed Oct 20 19:20:59.121211 202000] [rewrite:trace3] [pid 121591:tid 140413273032448] mod_rewrite.c(470): [client 10.121.192.8:38350] 10.121.192.8 - - [dev.elastic.co/sid#55a374e851c8][rid#7fb438083ac0/initial] applying pattern '^/import/?(.*)$' to uri '/'

parse:
  logpar:
    - event.original: "[<~pedro1/timestamp/APACHE_ERROR>]"
    - event.original: "[<~pedro/timestamp/APACHE_ERROR>]"
